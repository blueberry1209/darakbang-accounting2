<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>ì£¼ë‹˜ì˜êµíšŒ ë‹¤ë½ë°© íšŒê³„ì¥ë¶€</title>
    <style>
        /* ëª¨ë“  ìš”ì†Œì˜ ë§ˆì§„, íŒ¨ë”© ì´ˆê¸°í™” ë° ë°•ìŠ¤ ëª¨ë¸ ì„¤ì • */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ë°”ë”” ìŠ¤íƒ€ì¼: í°íŠ¸, ë°°ê²½ ê·¸ë¼ë°ì´ì…˜, ìµœì†Œ ë†’ì´ ì„¤ì • */
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f5f2f0 0%, #e8e4e0 50%, #f0efec 100%);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* ë¡œê·¸ì¸ í™”ë©´ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼: í™”ë©´ ì¤‘ì•™ ì •ë ¬ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #d4b5a0 0%, #c8a48a 25%, #a68b7a 50%, #8b7a6b 75%, #c8b5a4 100%);
        }

        /* ë¡œê·¸ì¸ í¼ ìŠ¤íƒ€ì¼: ë°°ê²½, íŒ¨ë”©, ê·¸ë¦¼ì, í…Œë‘ë¦¬, ì¤‘ì•™ ì •ë ¬ */
        .login-form {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(139, 122, 107, 0.2);
            text-align: center;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(212, 181, 160, 0.3);
        }

        /* ë¡œê·¸ì¸ í¼ ì œëª© ìŠ¤íƒ€ì¼ */
        .login-form h1 {
            color: #8b7a6b;
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        /* ë¡œê·¸ì¸ í¼ ì„¤ëª… í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .login-form p {
            color: #a68b7a;
            margin-bottom: 30px;
        }

        /* ë¡œê·¸ì¸ í¼ ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼: ë„ˆë¹„, íŒ¨ë”©, í…Œë‘ë¦¬, í°íŠ¸, ë§ˆì§„, ë°°ê²½, ì „í™˜ íš¨ê³¼ */
        .login-form input {
            width: 100%;
            padding: 15px;
            border: 2px solid #d4b5a0;
            border-radius: 25px;
            font-size: 16px;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        /* ë¡œê·¸ì¸ í¼ ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ ì‹œ ìŠ¤íƒ€ì¼ */
        .login-form input:focus {
            outline: none;
            border-color: #8b7a6b;
            background: white;
            transform: scale(1.02);
        }

        /* ë¡œê·¸ì¸ í¼ ë²„íŠ¼ ìŠ¤íƒ€ì¼: ë„ˆë¹„, íŒ¨ë”©, ë°°ê²½, ìƒ‰ìƒ, í…Œë‘ë¦¬, í°íŠ¸, ì»¤ì„œ, ì „í™˜ íš¨ê³¼ */
        .login-form button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #c8a48a 0%, #d4b5a0 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* ë¡œê·¸ì¸ í¼ ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        .login-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(200, 164, 138, 0.4);
        }

        /* ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸° ìˆ¨ê¹€ */
        .main-app {
            display: none;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼: ë°°ê²½ ê·¸ë¼ë°ì´ì…˜, ìƒ‰ìƒ, íŒ¨ë”©, ì¤‘ì•™ ì •ë ¬, ê·¸ë¦¼ì, í•˜ë‹¨ í…Œë‘ë¦¬ */
        header {
            background: linear-gradient(135deg, #8b7a6b 0%, #a68b7a 50%, #7d8471 100%);
            color: white;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(139, 122, 107, 0.3);
            border-bottom: 3px solid rgba(255, 255, 255, 0.2);
        }

        /* í—¤ë” ì œëª© ìŠ¤íƒ€ì¼: í…ìŠ¤íŠ¸ ê·¸ë¦¼ì */
        header h1 {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 5px;
        }

        /* í—¤ë” ì„¤ëª… í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼: íˆ¬ëª…ë„ */
        header p {
            opacity: 0.9;
        }

        /* ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼: ìœ„ì¹˜, ë°°ê²½, ìƒ‰ìƒ, í…Œë‘ë¦¬, íŒ¨ë”©, í°íŠ¸, ì»¤ì„œ, ì „í™˜ íš¨ê³¼ */
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        /* ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        .logout-btn:hover {
            background: white;
            color: #8b7a6b;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ ë°” ìŠ¤íƒ€ì¼: ë°°ê²½ ê·¸ë¼ë°ì´ì…˜, íŒ¨ë”©, ì¤‘ì•™ ì •ë ¬, ê°€ë¡œ ìŠ¤í¬ë¡¤, ê·¸ë¦¼ì */
        nav {
            background: linear-gradient(135deg, #b5c2a8 0%, #a8b59c 50%, #9ca892 100%);
            padding: 15px;
            text-align: center;
            overflow-x: auto;
            white-space: nowrap;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼: ë°°ê²½ ê·¸ë¼ë°ì´ì…˜, ìƒ‰ìƒ, í…Œë‘ë¦¬, íŒ¨ë”©, ë§ˆì§„, í°íŠ¸, ì»¤ì„œ, ì „í™˜ íš¨ê³¼ */
        nav button {
            background: linear-gradient(135deg, #d4d8ce 0%, #c8ccc2 100%);
            color: #5a5a5a;
            border: none; /* Yellow border removed */
            padding: 12px 20px;
            margin: 0 5px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            min-height: 44px;
            display: inline-block;
            font-weight: 500;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        nav button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 216, 206, 0.4);
        }

        /* í™œì„±í™”ëœ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        nav button.active {
            background: linear-gradient(135deg, #8b7a6b 0%, #a68b7a 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(139, 122, 107, 0.3);
        }

        /* ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼: ìµœëŒ€ ë„ˆë¹„, ì¤‘ì•™ ì •ë ¬, íŒ¨ë”© */
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }

        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼: ë°°ê²½, ë§ˆì§„, íŒ¨ë”©, í…Œë‘ë¦¬, ê·¸ë¦¼ì, ì´ˆê¸° ìˆ¨ê¹€ */
        .section {
            background: rgba(255, 255, 255, 0.95);
            margin: 20px 0;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(139, 122, 107, 0.1);
            display: none;
            border: 2px solid rgba(212, 181, 160, 0.2);
            backdrop-filter: blur(10px);
        }

        /* í™œì„±í™”ëœ ì„¹ì…˜ í‘œì‹œ */
        .section.active {
            display: block;
        }

        /* ì´ˆê¸° ì„¤ì • ì„¹ì…˜ ê³ ìœ  ìŠ¤íƒ€ì¼ */
        .setup-section {
            background: linear-gradient(135deg, #f5f2f0 0%, #e8e4e0 100%);
            border: 3px solid #d4b5a0;
        }

        /* ì”ì•¡ ìš”ì•½ ì¹´ë“œ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼: ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ */
        .balance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        /* ì”ì•¡ ì¹´ë“œ ìŠ¤íƒ€ì¼: ë°°ê²½ ê·¸ë¼ë°ì´ì…˜, ìƒ‰ìƒ, íŒ¨ë”©, í…Œë‘ë¦¬, ê·¸ë¦¼ì */
        .balance-card {
            background: linear-gradient(135deg, #9ca892 0%, #a8b59c 100%);
            color: white;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(156, 168, 146, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        /* ì”ì•¡ ì¹´ë“œ ì œëª© ìŠ¤íƒ€ì¼ */
        .balance-card h3 {
            margin-bottom: 10px;
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* ì”ì•¡ ì¹´ë“œ ê¸ˆì•¡ ìŠ¤íƒ€ì¼ */
        .balance-card .amount {
            font-size: 1.8em;
            font-weight: bold;
            color: white;
        }

        /* í¼ ê·¸ë£¹ ìŠ¤íƒ€ì¼: ë§ˆì§„ */
        .form-group {
            margin-bottom: 20px;
        }

        /* í¼ ê·¸ë£¹ ë¼ë²¨ ìŠ¤íƒ€ì¼: ë¸”ë¡ ìš”ì†Œ, ë§ˆì§„, í°íŠ¸ êµµê¸°, ìƒ‰ìƒ */
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #8b7a6b;
        }

        /* í¼ ê·¸ë£¹ ì…ë ¥, ì„ íƒ, í…ìŠ¤íŠ¸ ì˜ì—­ í•„ë“œ ìŠ¤íƒ€ì¼ */
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #d4b5a0;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        /* í¼ ê·¸ë£¹ ì…ë ¥, ì„ íƒ, í…ìŠ¤íŠ¸ ì˜ì—­ í•„ë“œ í¬ì»¤ìŠ¤ ì‹œ ìŠ¤íƒ€ì¼ */
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #8b7a6b;
            background: white;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(139, 122, 107, 0.2);
        }

        /* ì¼ë°˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn {
            background: linear-gradient(135deg, #a8b59c 0%, #9ca892 100%);
            color: white;
            border: none; /* Yellow border removed */
            padding: 15px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            min-height: 44px;
            width: 100%;
        }

        /* ì¼ë°˜ ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(168, 181, 156, 0.4);
        }

        /* ì„±ê³µ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-success {
            background: linear-gradient(135deg, #7d8471 0%, #6b7560 100%);
            color: white;
        }

        /* ì„±ê³µ ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        .btn-success:hover {
            box-shadow: 0 5px 15px rgba(125, 132, 113, 0.4);
        }

        /* ìœ„í—˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-danger {
            background: linear-gradient(135deg, #c8a48a 0%, #b5936d 100%);
            color: white;
        }

        /* ìœ„í—˜ ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        .btn-danger:hover {
            box-shadow: 0 5px 15px rgba(200, 164, 138, 0.4);
        }

        /* ê²½ê³  ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-warning {
            background: linear-gradient(135deg, #d4b5a0 0%, #c8a48a 100%);
            color: white;
        }

        /* ê²½ê³  ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        .btn-warning:hover {
            box-shadow: 0 5px 15px rgba(212, 181, 160, 0.4);
        }

        /* ì •ë³´ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-info {
            background: linear-gradient(135deg, #9ca892 0%, #8b9480 100%);
            color: white;
        }

        /* ì •ë³´ ë²„íŠ¼ í˜¸ë²„ ì‹œ ìŠ¤íƒ€ì¼ */
        .btn-info:hover {
            box-shadow: 0 5px 15px rgba(156, 168, 146, 0.4);
        }

        /* ê±°ë˜ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .transaction-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            overflow-x: auto;
            display: block;
            white-space: nowrap;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
        }

        /* ê±°ë˜ í…Œì´ë¸” í—¤ë” ë° ë°”ë”” ìŠ¤íƒ€ì¼ */
        .transaction-table thead, .transaction-table tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        /* ê±°ë˜ í…Œì´ë¸” í—¤ë” ë° ì…€ ìŠ¤íƒ€ì¼ */
        .transaction-table th, .transaction-table td {
            padding: 15px 12px;
            text-align: left;
            border-bottom: 1px solid #d4b5a0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* ê±°ë˜ í…Œì´ë¸” í—¤ë” ìŠ¤íƒ€ì¼ */
        .transaction-table th {
            background: linear-gradient(135deg, #f5f2f0 0%, #e8e4e0 100%);
            font-weight: bold;
            position: sticky;
            top: 0;
            color: #8b7a6b;
        }

        /* ìˆ˜ì… ê¸ˆì•¡ ìƒ‰ìƒ */
        .income {
            color: #7d8471;
            font-weight: bold;
        }

        /* ì§€ì¶œ ê¸ˆì•¡ ìƒ‰ìƒ */
        .expense {
            color: #c8a48a;
            font-weight: bold;
        }

        /* ë³´ê³ ì„œ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .report-section {
            margin: 20px 0;
            padding: 25px;
            background: linear-gradient(135deg, #f5f2f0 0%, #e8e4e0 100%);
            border-radius: 15px;
            border: 2px solid rgba(212, 181, 160, 0.3);
        }

        /* íšŒê³„ ë³´ê³ ì„œ íƒ­ ì „ìš© í°íŠ¸ í¬ê¸° ì¡°ì • */
        #report {
            font-size: 14px; /* ê¸°ë³¸ í°íŠ¸ í¬ê¸°ë¥¼ 14pxë¡œ ì¤„ì„ */
        }

        #report h2 {
            font-size: 20px; /* ë©”ì¸ ì œëª© í¬ê¸° ì¡°ì • */
        }

        #report h3 {
            font-size: 16px; /* ì„œë¸Œ ì œëª© í¬ê¸° ì¡°ì • */
        }

        #report p {
            font-size: 13px; /* ë³¸ë¬¸ í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì • */
            line-height: 1.4; /* ì¤„ ê°„ê²© ì¡°ì • */
        }

        #report .btn {
            font-size: 14px; /* ë²„íŠ¼ í°íŠ¸ í¬ê¸° ì¡°ì • */
            padding: 12px 20px; /* ë²„íŠ¼ íŒ¨ë”© ì¡°ì • */
        }

        /* ë‘ ì»¬ëŸ¼ ë ˆì´ì•„ì›ƒ ìŠ¤íƒ€ì¼ */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        /* ì•Œë¦¼ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .alert {
            padding: 20px;
            margin: 20px 0;
            border-radius: 15px;
            border-left: 4px solid;
        }

        /* ê²½ê³  ì•Œë¦¼ ìŠ¤íƒ€ì¼ */
        .alert-warning {
            background: linear-gradient(135deg, #f5f2f0 0%, #e8e4e0 100%);
            border-color: #d4b5a0;
            color: #8b7a6b;
        }

        /* ì •ë³´ ì•Œë¦¼ ìŠ¤íƒ€ì¼ */
        .alert-info {
            background: linear-gradient(135deg, #d4d8ce 0%, #c8ccc2 100%);
            border-color: #9ca892;
            color: #5a5a5a;
        }

        /* ì„¤ì • í¼ ìŠ¤íƒ€ì¼ */
        .settings-form {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #d4b5a0;
            margin-bottom: 20px;
        }

        /* ë³´ê³ ì„œ ìš”ì•½ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .report-summary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            overflow: hidden; /* For rounded corners on table */
            font-size: 12px; /* í…Œì´ë¸” í°íŠ¸ í¬ê¸° ì¤„ì„ */
        }

        .report-summary-table th, .report-summary-table td {
            padding: 8px 12px; /* íŒ¨ë”© ì¤„ì„ */
            text-align: left;
            border-bottom: 1px solid #e0d9d4;
        }

        .report-summary-table th {
            background-color: #f0efec;
            font-weight: bold;
            color: #8b7a6b;
            font-size: 11px; /* í—¤ë” í°íŠ¸ ë” ì‘ê²Œ */
        }

        .report-summary-table tr:last-child td {
            border-bottom: none;
        }

        .report-summary-table .total-row td {
            font-weight: bold;
            background-color: #e8e4e0;
        }
        .report-summary-table .total-row .amount {
            color: #8b7a6b; /* Adjust color for total amounts */
        }
        .report-summary-table .income-amount {
            color: #7d8471;
        }
        .report-summary-table .expense-amount {
            color: #c8a48a;
        }
        .report-summary-table .balance-amount {
            color: #5a5a5a;
        }

        /* ë¯¸ë””ì–´ ì¿¼ë¦¬: 768px ì´í•˜ í™”ë©´ (ëª¨ë°”ì¼) */
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr; /* ë‘ ì»¬ëŸ¼ì„ í•œ ì»¬ëŸ¼ìœ¼ë¡œ ë³€ê²½ */
            }

            .balance-summary {
                grid-template-columns: 1fr; /* ì”ì•¡ ìš”ì•½ ì¹´ë“œë„ í•œ ì»¬ëŸ¼ìœ¼ë¡œ ë³€ê²½ */
            }

            .logout-btn {
                position: relative; /* ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ìœ„ì¹˜ ì¡°ì • */
                top: auto;
                right: auto;
                margin-top: 10px;
                width: 100%;
            }

            nav {
                padding: 10px; /* ë„¤ë¹„ê²Œì´ì…˜ íŒ¨ë”© ì¡°ì • */
            }

            nav button {
                padding: 12px 15px; /* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ íŒ¨ë”© ì¡°ì • */
                margin: 2px;
                font-size: 13px;
            }

            /* ëª¨ë°”ì¼ì—ì„œ íšŒê³„ ë³´ê³ ì„œ í°íŠ¸ ë” ì‘ê²Œ */
            #report {
                font-size: 12px;
            }

            #report h2 {
                font-size: 18px;
            }

            #report h3 {
                font-size: 14px;
            }

            #report p {
                font-size: 11px;
            }
        }

        /* íšŒê³„ ë³´ê³ ì„œ ì„¹ì…˜ í…ìŠ¤íŠ¸ êµµê¸° ì¡°ì • */
        .report-section h3,
        .report-section p strong {
            font-weight: normal; /* ê¸°ë³¸ ê¸€ì êµµê¸°ë¡œ ì„¤ì • */
        }
        .report-section p {
            font-weight: normal; /* ëª¨ë“  p íƒœê·¸ì˜ í°íŠ¸ êµµê¸°ë¥¼ ê¸°ë³¸ìœ¼ë¡œ */
        }
        .report-section strong {
            font-weight: 600; /* í•„ìš”í•œ ê²½ìš° strong íƒœê·¸ëŠ” ì•½ê°„ êµµê²Œ ìœ ì§€ */
        }
        .report-section .amount {
            font-weight: bold; /* ê¸ˆì•¡ì€ ì—¬ì „íˆ êµµê²Œ ìœ ì§€ */
        }

        /* ì¸ì‡„ ì‹œ ìŠ¤íƒ€ì¼ */
        @media print {
            body * {
                visibility: hidden; /* ëª¨ë“  ìš”ì†Œ ìˆ¨ê¸°ê¸° */
            }
            /* ë³´ê³ ì„œ ì„¹ì…˜ ì „ì²´ë¥¼ ë³´ì´ë„ë¡ ì„¤ì • */
            #report {
                visibility: visible;
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0;
                padding: 10px; /* íŒ¨ë”© ì¤„ì„ */
                box-shadow: none;
                border: none;
                background: none;
                backdrop-filter: none;
                font-size: 11px; /* ì¸ì‡„ ì‹œ í°íŠ¸ ë” ì‘ê²Œ */
            }
            /* ë³´ê³ ì„œ ì„¹ì…˜ ë‚´ì˜ ëª¨ë“  ìì‹ ìš”ì†Œë„ ë³´ì´ë„ë¡ ì„¤ì • */
            #report * {
                visibility: visible;
            }

            /* 'íšŒê³„ ê¸°ê°„ ì„¤ì •' ì„¹ì…˜ ìˆ¨ê¸°ê¸° */
            #report .report-section.print-hidden {
                display: none;
            }

            /* ë³´ê³ ì„œ ì„¹ì…˜ ë‚´ì˜ íŠ¹ì • ìš”ì†Œë“¤ì— ëŒ€í•œ ì¸ì‡„ ìŠ¤íƒ€ì¼ */
            #report .report-section {
                box-shadow: none;
                border: none;
                background: none;
                padding: 0;
                margin: 8px 0; /* ë§ˆì§„ ì¤„ì„ */
            }

            #report h2 {
                font-size: 16px; /* ì¸ì‡„ ì‹œ ì œëª© í¬ê¸° */
                margin-bottom: 10px;
            }

            #report h3 {
                font-size: 13px; /* ì¸ì‡„ ì‹œ ì„œë¸Œ ì œëª© í¬ê¸° */
                margin-bottom: 8px;
            }

            #report p {
                font-size: 10px; /* ì¸ì‡„ ì‹œ ë³¸ë¬¸ í¬ê¸° */
                line-height: 1.3;
                margin: 2px 0;
            }

            #report .report-summary-table {
                box-shadow: none;
                border-radius: 0;
                background: none;
                border: 1px solid #ccc; /* ì¸ì‡„ ì‹œ í…Œì´ë¸” í…Œë‘ë¦¬ ì¶”ê°€ */
                font-size: 10px; /* ì¸ì‡„ ì‹œ í…Œì´ë¸” í°íŠ¸ ë” ì‘ê²Œ */
                margin-top: 8px;
            }
            #report .report-summary-table th, #report .report-summary-table td {
                border: 1px solid #ccc; /* ì¸ì‡„ ì‹œ ì…€ í…Œë‘ë¦¬ ì¶”ê°€ */
                padding: 4px 8px; /* ì¸ì‡„ ì‹œ íŒ¨ë”© ë” ì¤„ì„ */
                font-size: 9px; /* ì¸ì‡„ ì‹œ ì…€ í°íŠ¸ ë” ì‘ê²Œ */
            }
            #report .report-summary-table .total-row td {
                background-color: #f0f0f0; /* ì¸ì‡„ ì‹œ ë°°ê²½ìƒ‰ ì¡°ì • */
                font-weight: bold;
            }
            /* ì¸ì‡„ ì‹œ ë²„íŠ¼ ìˆ¨ê¸°ê¸° */
            #report .btn {
                display: none;
            }
            /* ë³´ê³ ì„œ ì •ë³´ (ë‹¤ë½ë°© ì´ë¦„, ê¸°ê°„ ë“±)ë„ ì¸ì‡„ ì‹œ ë³´ì´ë„ë¡ */
            #report .report-section p {
                visibility: visible;
                color: #000; /* ì¸ì‡„ ì‹œ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ê²€ì •ìœ¼ë¡œ */
            }
            #report .report-section strong {
                visibility: visible;
                color: #000;
            }

            /* ì¸ì‡„ ì‹œ í˜ì´ì§€ ë‚˜ëˆ„ê¸° ë°©ì§€ */
            #report .report-summary-table {
                page-break-inside: avoid;
            }
            
            /* ì¸ì‡„ ì‹œ ì—¬ë°± ìµœì†Œí™” */
            @page {
                margin: 0.5in;
                size: A4;
            }
        }
    </style>
</head>
<body>
    <div id="loginScreen" class="login-container">
        <div class="login-form">
            <h1>ğŸ›ï¸ ì£¼ë‹˜ì˜êµíšŒ ë‹¤ë½ë°© íšŒê³„ì¥ë¶€</h1>
            <p>íšŒê³„ ê´€ë¦¬ë¥¼ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
            <input type="password" id="passwordInput" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" onkeypress="checkEnterKey(event)">
            <button onclick="login()">ë¡œê·¸ì¸</button>
            <p style="font-size: 12px; color: #999; margin-top: 20px;">
                ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸: 1234 (ì„¤ì •ì—ì„œ ë³€ê²½ ê°€ëŠ¥)
            </p>
        </div>
    </div>

    <div id="mainApp" class="main-app">
        <header>
            <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            <h1>ğŸ›ï¸ <span id="headerDarakbangName">ì£¼ë‹˜ì˜êµíšŒ ë‹¤ë½ë°©</span> íšŒê³„ì¥ë¶€</h1>
            <p>íˆ¬ëª…í•˜ê³  ì²´ê³„ì ì¸ íšŒê³„ ê´€ë¦¬</p>
        </header>

        <nav>
            <button onclick="showSection('setup')" class="active">ì´ˆê¸°ì„¤ì •</button>
            <button onclick="showSection('dashboard')">ëŒ€ì‹œë³´ë“œ</button>
            <button onclick="showSection('transaction')">ì…ì¶œê¸ˆë“±ë¡</button>
            <button onclick="showSection('history')">ê±°ë˜ë‚´ì—­</button>
            <button onclick="showSection('report')">íšŒê³„ë³´ê³ ì„œ</button>
        </nav>

        <div class="container">
            <div id="setup" class="section active setup-section">
                <h2>âš™ï¸ ì´ˆê¸° ì„¤ì •</h2>
                <div class="alert alert-warning">
                    <strong>ì¤‘ìš”!</strong> íšŒê³„ ì‹œì‘ ì „ì— ê¸°ì¤€ ë‚ ì§œì™€ ì´ì›” ì”ê³ ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.
                </div>

                <div id="setupForm" class="settings-form">
                    <div class="form-group">
                        <label>ë‹¤ë½ë°© ì´ë¦„</label>
                        <input type="text" id="setupDarakbangName" placeholder="ë‹¤ë½ë°© ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label>íšŒê³„ ê¸°ì¤€ ë‚ ì§œ</label>
                        <input type="date" id="baseDate" value="">
                    </div>

                    <div class="form-group">
                        <label>ì´ì›” ì”ê³  (ì›)</label>
                        <input type="number" id="carryOverInput" placeholder="ì˜ˆ: 50000" value="50000">
                    </div>

                    <div class="form-group">
                        <label>ë‹´ë‹¹ì ì´ë¦„</label>
                        <input type="text" id="managerName" placeholder="íšŒê³„ ë‹´ë‹¹ì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>

                    <div class="form-group">
                        <label>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (ì„ íƒì‚¬í•­)</label>
                        <input type="password" id="newPassword" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ (ê¸°ë³¸ê°’: 1234)">
                    </div>

                    <button onclick="saveInitialSettings()" class="btn btn-success">ì„¤ì • ì €ì¥</button>
                </div>

                <div id="currentSettings" style="margin-top: 30px; padding: 20px; background: rgba(255, 255, 255, 0.8); border-radius: 15px; display: none;">
                    <h3>í˜„ì¬ ì„¤ì •</h3>
                    <p><strong>ë‹¤ë½ë°© ì´ë¦„:</strong> <span id="currentDarakbangName">-</span></p>
                    <p><strong>ê¸°ì¤€ ë‚ ì§œ:</strong> <span id="currentBaseDate">-</span></p>
                    <p><strong>ì´ì›” ì”ê³ :</strong> <span id="currentCarryOver">-</span></p>
                    <p><strong>ë‹´ë‹¹ì:</strong> <span id="currentManager">-</span></p>

                    <div class="alert alert-warning" style="margin-top: 20px;">
                        <strong>âš ï¸ ì£¼ì˜!</strong> ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ë©´ ëª¨ë“  ê±°ë˜ ë‚´ì—­ì´ ì‚­ì œë©ë‹ˆë‹¤.
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button onclick="editSettings()" class="btn btn-warning" style="flex: 1;">ì„¤ì • ìˆ˜ì •</button>
                        <button onclick="resetAllData()" class="btn btn-danger" style="flex: 1;">ì „ì²´ ì´ˆê¸°í™”</button>
                    </div>
                </div>
            </div>

            <div id="dashboard" class="section">
                <h2>ğŸ“Š íšŒê³„ í˜„í™© ëŒ€ì‹œë³´ë“œ</h2>
                <div class="balance-summary">
                    <div class="balance-card">
                        <h3>ì´ì›” ì”ê³ </h3>
                        <div class="amount" id="carryOverBalance">0ì›</div>
                    </div>
                    <div class="balance-card">
                        <h3>ì´ ì…ê¸ˆ</h3>
                        <div class="amount" id="totalIncome">0ì›</div>
                    </div>
                    <div class="balance-card">
                        <h3>ì´ ì¶œê¸ˆ</h3>
                        <div class="amount" id="totalExpense">0ì›</div>
                    </div>
                    <div class="balance-card">
                        <h3>í˜„ì¬ ì”ì•¡</h3>
                        <div class="amount" id="currentBalance">0ì›</div>
                    </div>
                </div>

                <div class="two-column">
                    <div class="report-section">
                        <h3>ğŸ“ˆ ì´ë²ˆ ë‹¬ ìš”ì•½</h3>
                        <p><strong>ë‹¤ë½ë°© ì´ë¦„:</strong> <span id="dashboardDarakbangName">-</span></p>
                        <p><strong>ê±°ë˜ ê±´ìˆ˜:</strong> <span id="transactionCount">0ê±´</span></p>
                        <p><strong>ìµœê·¼ ê±°ë˜ì¼:</strong> <span id="lastTransactionDate">-</span></p>
                    </div>

                    <div class="report-section">
                        <h3>â° ë¹ ë¥¸ ì‘ì—…</h3>
                        <button onclick="showSection('transaction')" class="btn" style="margin-bottom: 10px;">ğŸ’° ì…ì¶œê¸ˆ ë“±ë¡</button>
                        <button onclick="showSection('history')" class="btn btn-warning" style="margin-bottom: 10px;">ğŸ“‹ ê±°ë˜ ë‚´ì—­</button>
                        <button onclick="showSection('report')" class="btn btn-info">ğŸ“Š íšŒê³„ ë³´ê³ ì„œ</button>
                     </div>
                </div>
            </div>

            <div id="transaction" class="section">
                <h2>ğŸ’° ì…ì¶œê¸ˆ ë“±ë¡</h2>

                <div class="two-column">
                    <div>
                        <h3>âœ… ì…ê¸ˆ ë“±ë¡</h3>
                        <div class="form-group">
                            <label>ì…ê¸ˆì•¡</label>
                            <input type="number" id="incomeAmount" placeholder="ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label>ì…ê¸ˆ ë‚´ì—­</label>
                            <select id="incomeCategory">
                                <option value="ë‹¤ë½ë°© í—Œê¸ˆ">ë‹¤ë½ë°© í—Œê¸ˆ</option>
                                <option value="ëª¨ì„ë¹„">ëª¨ì„ë¹„</option>
                                <option value="í›„ì›ê¸ˆ">í›„ì›ê¸ˆ</option>
                                <option value="ì´ììˆ˜ì…">ì´ììˆ˜ì…</option>
                                <option value="ê¸°íƒ€ìˆ˜ì…">ê¸°íƒ€ìˆ˜ì…</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ìƒì„¸ ë‚´ìš©</label>
                            <input type="text" id="incomeDescription" placeholder="ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label>ì…ê¸ˆì ì´ë¦„</label>
                            <input type="text" id="incomePersonName" placeholder="ì…ê¸ˆì ì´ë¦„">
                        </div>
                        <button onclick="addTransaction('income')" class="btn btn-success">ì…ê¸ˆ ë“±ë¡</button>
                    </div>

                    <div>
                        <h3>âŒ ì¶œê¸ˆ ë“±ë¡</h3>
                        <div class="form-group">
                            <label>ì¶œê¸ˆì•¡</label>
                            <input type="number" id="expenseAmount" placeholder="ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label>ì¶œê¸ˆ ë‚´ì—­</label>
                            <select id="expenseCategory">
                                <option value="ë‹¤ë½ë°© í—Œê¸ˆ">ë‹¤ë½ë°© í—Œê¸ˆ</option>
                                <option value="ì‹ì‚¬ë¹„">ì‹ì‚¬ë¹„</option>
                                <option value="ì—´ë¦° ë‹¤ë½ë°© ëª¨ì„ë¹„">ì—´ë¦° ë‹¤ë½ë°© ëª¨ì„ë¹„</option>
                                <option value="ì„ ë¬¼ë¹„">ì„ ë¬¼ë¹„</option>
                                <option value="í–‰ì‚¬ë¹„">í–‰ì‚¬ë¹„</option>
                                <option value="ê¸°íƒ€ì§€ì¶œ">ê¸°íƒ€ì§€ì¶œ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ìƒì„¸ ë‚´ìš©</label>
                            <input type="text" id="expenseDescription" placeholder="ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        <div class="form-group">
                            <label>ì§€ì¶œì ì´ë¦„</label>
                            <input type="text" id="expensePersonName" placeholder="ì§€ì¶œì ì´ë¦„">
                        </div>
                        <button onclick="addTransaction('expense')" class="btn btn-danger">ì¶œê¸ˆ ë“±ë¡</button>
                    </div>
                </div>
            </div>

            <div id="history" class="section">
                <h2>ğŸ“‹ ê±°ë˜ ë‚´ì—­</h2>
                <div style="overflow-x: auto;">
                    <table class="transaction-table">
                        <thead>
                            <tr>
                                <th>ë‚ ì§œ</th> <th>êµ¬ë¶„</th>
                                <th>ì¹´í…Œê³ ë¦¬</th>
                                <th>ë‚´ìš©</th>
                                <th>ë‹´ë‹¹ì</th>
                                <th>ê¸ˆì•¡</th>
                                <th>ì”ì•¡</th>
                                <th>ì‚­ì œ</th>
                            </tr>
                        </thead>
                        <tbody id="transactionHistory">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="report" class="section">
                <h2>ğŸ“Š íšŒê³„ ê²°ì‚° ë³´ê³ ì„œ</h2>

                <div class="report-section print-hidden"> <!-- ì´ ë¶€ë¶„ì„ ì¸ì‡„ ì‹œ ìˆ¨ê¹€ -->
                    <h3>ğŸ“… íšŒê³„ ê¸°ê°„ ì„¤ì •</h3>
                    <div class="two-column">
                        <div class="form-group">
                            <label>ì‹œì‘ ë‚ ì§œ</label>
                            <input type="date" id="reportStartDate" value="" placeholder="ì‹œì‘ ë‚ ì§œ ì„ íƒ">
                        </div>
                        <div class="form-group">
                            <label>ì¢…ë£Œ ë‚ ì§œ</label>
                            <input type="date" id="reportEndDate" value="" placeholder="ì¢…ë£Œ ë‚ ì§œ ì„ íƒ">
                        </div>
                    </div>

                    <div style="text-align: center; margin: 20px 0;">
                        <button onclick="generateReport()" class="btn btn-success" style="padding: 15px 30px; font-size: 18px;">ğŸ“„ ì„ íƒ ê¸°ê°„ í™•ì¸</button>
                    </div>
                </div>

                <div class="report-section">
                    <div style="background: rgba(255, 255, 255, 0.8); padding: 15px; border-radius: 10px; text-align: center;">
                        <p><strong>ë‹¤ë½ë°© ì´ë¦„:</strong> <span id="reportDarakbangName">-</span></p>
                        <p><strong>ë³´ê³ ì„œ ê¸°ê°„:</strong> <span id="reportPeriod">ì „ì²´ ê¸°ê°„</span></p>
                        <p><strong>ë‹´ë‹¹ì:</strong> <span id="reportManager">-</span> | <strong>ì‘ì„±ì¼:</strong> <span id="reportDate">-</span></p>
                    </div>
                </div>

                <div class="report-section">
                    <h3>ğŸ“‹ ê²°ì‚° ìš”ì•½</h3>
                    <table class="report-summary-table" id="consolidatedReport">
                        <thead>
                            <tr>
                                <th>í•­ëª©</th>
                                <th>ê¸ˆì•¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Consolidated report rows will be inserted here by JS -->
                        </tbody>
                    </table>
                </div>

                <div style="text-align: center; margin-top: 30px;" class="print-hidden"> <!-- ì´ ë²„íŠ¼ë„ ì¸ì‡„ ì‹œ ìˆ¨ê¹€ -->
                    <button onclick="printReport()" class="btn btn-info">ğŸ–¨ï¸ ë³´ê³ ì„œ ì¸ì‡„</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™”
        let transactions = []; // ê±°ë˜ ë‚´ì—­ì„ ì €ì¥í•˜ëŠ” ë°°ì—´
        let currentPassword = '1234'; // í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ (ê¸°ë³¸ê°’ 1234)
        let settings = { // ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •ì„ ì €ì¥í•˜ëŠ” ê°ì²´
            darakbangName: '', // ë‹¤ë½ë°© ì´ë¦„ ì¶”ê°€
            baseDate: '', // íšŒê³„ ê¸°ì¤€ ë‚ ì§œ
            carryOverBalance: 0, // ì´ì›” ì”ê³ 
            managerName: '', // ë‹´ë‹¹ì ì´ë¦„
            isSetup: false // ì´ˆê¸° ì„¤ì • ì™„ë£Œ ì—¬ë¶€
        };

        // ë°ì´í„°ë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
        function saveData() {
            try {
                const data = {
                    transactions: transactions,
                    settings: settings,
                    currentPassword: currentPassword,
                    lastSaved: new Date().toISOString() // ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„
                };
                localStorage.setItem('darakbang-accounting-data', JSON.stringify(data));
            } catch (error) {
                console.error('ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜:', error); // ì˜¤ë¥˜ ë°œìƒ ì‹œ ì½˜ì†”ì— ì¶œë ¥
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
        function loadData() {
            try {
                const savedData = localStorage.getItem('darakbang-accounting-data');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    transactions = data.transactions || []; // ê±°ë˜ ë‚´ì—­ ë¶ˆëŸ¬ì˜¤ê¸° (ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´)
                    settings = data.settings || { // ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° (ì—†ìœ¼ë©´ ê¸°ë³¸ê°’)
                        darakbangName: '',
                        baseDate: '',
                        carryOverBalance: 0,
                        managerName: '',
                        isSetup: false
                    };
                    currentPassword = data.currentPassword || '1234'; // ë¹„ë°€ë²ˆí˜¸ ë¶ˆëŸ¬ì˜¤ê¸° (ì—†ìœ¼ë©´ 1234)
                    return true; // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì„±ê³µ
                }
            } catch (error) {
                console.error('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜:', error); // ì˜¤ë¥˜ ë°œìƒ ì‹œ ì½˜ì†”ì— ì¶œë ¥
            }
            return false; // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨
        }

        // ì—”í„° í‚¤ ì…ë ¥ ì‹œ ë¡œê·¸ì¸ í•¨ìˆ˜ í˜¸ì¶œ
        function checkEnterKey(event) {
            if (event.key === 'Enter') {
                login();
            }
        }

        // ë¡œê·¸ì¸ ì²˜ë¦¬ í•¨ìˆ˜
        function login() {
            const password = document.getElementById('passwordInput').value; // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°

            // ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
            if (password === currentPassword) {
                // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í™”ë©´ ì „í™˜ ë° ë°ì´í„° ì—…ë°ì´íŠ¸
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                loadSettings(); // ì„¤ì • ë¡œë“œ
                setTodayAsDefault(); // ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ë³¸ê°’ ì„¤ì •
                updateAllDisplays(); // ëª¨ë“  í™”ë©´ ì—…ë°ì´íŠ¸
                updateHeaderDarakbangName(); // í—¤ë” ë‹¤ë½ë°© ì´ë¦„ ì—…ë°ì´íŠ¸
                generateReport(); // ë¡œê·¸ì¸ ì‹œ ë³´ê³ ì„œ ì´ˆê¸°í™”
            } else {
                // ì»¤ìŠ¤í…€ ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ
                showCustomAlert('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                document.getElementById('passwordInput').value = ''; // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            }
        }

        // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ í•¨ìˆ˜
        function logout() {
            showCustomConfirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?', () => { // ë¡œê·¸ì•„ì›ƒ í™•ì¸ ëŒ€í™”ìƒì
                document.getElementById('loginScreen').style.display = 'flex'; // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
                document.getElementById('mainApp').style.display = 'none'; // ë©”ì¸ ì•± ìˆ¨ê¹€
                document.getElementById('passwordInput').value = ''; // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ì„¤ì • í™•ì¸ ë° í™”ë©´ í‘œì‹œ
        window.onload = function() {
            loadData(); // ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

            document.getElementById('loginScreen').style.display = 'flex'; // ë¡œê·¸ì¸ í™”ë©´ ê¸°ë³¸ í‘œì‹œ
            document.getElementById('mainApp').style.display = 'none'; // ë©”ì¸ ì•± ê¸°ë³¸ ìˆ¨ê¹€
        };

        // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ë‚ ì§œ ì…ë ¥ í•„ë“œì˜ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
        function setTodayAsDefault() {
            const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë³€í™˜
            document.getElementById('baseDate').value = today;
        }

        // í—¤ë”ì˜ ë‹¤ë½ë°© ì´ë¦„ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        function updateHeaderDarakbangName() {
            const headerDarakbangName = document.getElementById('headerDarakbangName');
            if (settings.darakbangName) {
                headerDarakbangName.textContent = `${settings.darakbangName} ë‹¤ë½ë°©`;
            } else {
                headerDarakbangName.textContent = 'ì£¼ë‹˜ì˜êµíšŒ ë‹¤ë½ë°©';
            }
        }

        // ì´ˆê¸° ì„¤ì • ì €ì¥ í•¨ìˆ˜
        function saveInitialSettings() {
            const darakbangName = document.getElementById('setupDarakbangName').value.trim(); // ë‹¤ë½ë°© ì´ë¦„ ì…ë ¥ê°’
            const baseDate = document.getElementById('baseDate').value; // ê¸°ì¤€ ë‚ ì§œ ì…ë ¥ê°’
            const carryOver = parseInt(document.getElementById('carryOverInput').value) || 0; // ì´ì›” ì”ê³  ì…ë ¥ê°’
            const manager = document.getElementById('managerName').value.trim(); // ë‹´ë‹¹ì ì´ë¦„ ì…ë ¥ê°’
            const newPassword = document.getElementById('newPassword').value.trim(); // ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ê°’

            // í•„ìˆ˜ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬
            if (!darakbangName) {
                showCustomAlert('ë‹¤ë½ë°© ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            if (!baseDate) {
                showCustomAlert('ê¸°ì¤€ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            if (!manager) {
                showCustomAlert('ë‹´ë‹¹ì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì„¤ì • ê°ì²´ ì—…ë°ì´íŠ¸
            settings = {
                darakbangName: darakbangName, // ì„¤ì •ì— ë‹¤ë½ë°© ì´ë¦„ ì¶”ê°€
                baseDate: baseDate,
                carryOverBalance: carryOver,
                managerName: manager,
                isSetup: true
            };

            // ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì…ë ¥ë˜ì—ˆìœ¼ë©´ ë³€ê²½
            if (newPassword) {
                currentPassword = newPassword;
                showCustomAlert('ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            updateSettingsDisplay(); // ì„¤ì • í‘œì‹œ ì—…ë°ì´íŠ¸
            updateAllDisplays(); // ëª¨ë“  í™”ë©´ ì—…ë°ì´íŠ¸
            updateHeaderDarakbangName(); // í—¤ë” ë‹¤ë½ë°© ì´ë¦„ ì—…ë°ì´íŠ¸
            generateReport(); // ì„¤ì • ì €ì¥ ì‹œ ë³´ê³ ì„œ ì—…ë°ì´íŠ¸

            // ì„¤ì • í¼ ìˆ¨ê¸°ê³  í˜„ì¬ ì„¤ì • í‘œì‹œ
            document.getElementById('setupForm').style.display = 'none';
            document.getElementById('currentSettings').style.display = 'block';

            saveData(); // ë°ì´í„° ì €ì¥

            showCustomAlert('ì´ˆê¸° ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');

            document.getElementById('newPassword').value = ''; // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
        }

        // ì„¤ì • ìˆ˜ì • í•¨ìˆ˜
        function editSettings() {
            showCustomConfirm('ì„¤ì •ì„ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nê¸°ì¡´ ì„¤ì •ê°’ì´ ì…ë ¥ í¼ì— ë‹¤ì‹œ í‘œì‹œë©ë‹ˆë‹¤.', () => {
                // í˜„ì¬ ì„¤ì •ê°’ì„ ì…ë ¥ í¼ì— ë‹¤ì‹œ í‘œì‹œ
                document.getElementById('setupDarakbangName').value = settings.darakbangName; // ë‹¤ë½ë°© ì´ë¦„
                document.getElementById('baseDate').value = settings.baseDate;
                document.getElementById('carryOverInput').value = settings.carryOverBalance;
                document.getElementById('managerName').value = settings.managerName;

                // í¼ ë‹¤ì‹œ í‘œì‹œ
                document.getElementById('setupForm').style.display = 'block';
                document.getElementById('currentSettings').style.display = 'none';
            });
        }

        // ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜
        function resetAllData() {
            const confirmText = `ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

ì‚­ì œë  ë°ì´í„°:
â€¢ ì´ˆê¸° ì„¤ì • (ë‹¤ë½ë°© ì´ë¦„, ê¸°ì¤€ë‚ ì§œ, ì´ì›”ì”ê³ , ë‹´ë‹¹ì)
â€¢ ëª¨ë“  ê±°ë˜ ë‚´ì—­ (${transactions.length}ê±´)
â€¢ ë¹„ë°€ë²ˆí˜¸ëŠ” ê¸°ë³¸ê°’(1234)ìœ¼ë¡œ ì´ˆê¸°í™”

âš ï¸ ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`;

            showCustomConfirm(confirmText, () => {
                const finalConfirm = prompt('ì •ë§ë¡œ ì´ˆê¸°í™”í•˜ë ¤ë©´ "ì´ˆê¸°í™”"ë¼ê³  ì…ë ¥í•˜ì„¸ìš”:', '');

                if (finalConfirm === 'ì´ˆê¸°í™”') {
                    // ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
                    transactions = [];
                    currentPassword = '1234';
                    settings = {
                        darakbangName: '', // ë‹¤ë½ë°© ì´ë¦„ ì´ˆê¸°í™”
                        baseDate: '',
                        carryOverBalance: 0,
                        managerName: '',
                        isSetup: false
                    };

                    // í¼ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    document.getElementById('setupDarakbangName').value = ''; // ë‹¤ë½ë°© ì´ë¦„ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                    document.getElementById('baseDate').value = '';
                    document.getElementById('carryOverInput').value = '50000';
                    document.getElementById('managerName').value = '';
                    document.getElementById('newPassword').value = '';

                    // í™”ë©´ ìƒíƒœ ì´ˆê¸°í™”
                    document.getElementById('setupForm').style.display = 'block';
                    document.getElementById('currentSettings').style.display = 'none';

                    setTodayAsDefault(); // ì˜¤ëŠ˜ ë‚ ì§œ ë‹¤ì‹œ ì„¤ì •
                    updateAllDisplays(); // ëª¨ë“  í™”ë©´ ì—…ë°ì´íŠ¸
                    updateHeaderDarakbangName(); // í—¤ë” ë‹¤ë½ë°© ì´ë¦„ ì´ˆê¸°í™”
                    generateReport(); // ë°ì´í„° ì´ˆê¸°í™” ì‹œ ë³´ê³ ì„œë„ ì´ˆê¸°í™”

                    saveData(); // ì´ˆê¸°í™”ëœ ìƒíƒœ ì €ì¥

                    showCustomAlert('ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.\në¹„ë°€ë²ˆí˜¸ë„ ê¸°ë³¸ê°’(1234)ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    showCustomAlert('ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            });
        }

        // í˜„ì¬ ì„¤ì • ì •ë³´ë¥¼ í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function updateSettingsDisplay() {
            if (settings.isSetup) {
                document.getElementById('setupForm').style.display = 'none';
                document.getElementById('currentSettings').style.display = 'block';
                document.getElementById('currentDarakbangName').textContent = settings.darakbangName; // ë‹¤ë½ë°© ì´ë¦„ í‘œì‹œ
                document.getElementById('currentBaseDate').textContent = settings.baseDate;
                document.getElementById('currentCarryOver').textContent = settings.carryOverBalance.toLocaleString() + 'ì›';
                document.getElementById('currentManager').textContent = settings.managerName;
            } else {
                document.getElementById('setupForm').style.display = 'block';
                document.getElementById('currentSettings').style.display = 'none';
            }
        }

        // ì„¤ì • ì •ë³´ë¥¼ ë¡œë“œí•˜ì—¬ í™”ë©´ì— ë°˜ì˜í•˜ëŠ” í•¨ìˆ˜
        function loadSettings() {
            updateSettingsDisplay();
        }

        // ì„¹ì…˜ ì „í™˜ í•¨ìˆ˜
        function showSection(sectionName) {
            // ì´ˆê¸° ì„¤ì •ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìœ¼ë©´ 'setup' ì„¹ì…˜ ì™¸ì—ëŠ” ì ‘ê·¼ ë¶ˆê°€
            if (!settings.isSetup && sectionName !== 'setup') {
                showCustomAlert('ë¨¼ì € ì´ˆê¸° ì„¤ì •ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ëª¨ë“  ì„¹ì…˜ ë¹„í™œì„±í™”
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            // ëª¨ë“  ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ë¹„í™œì„±í™”
            const buttons = document.querySelectorAll('nav button');
            buttons.forEach(button => button.classList.remove('active'));

            // ì„ íƒëœ ì„¹ì…˜ ë° ë²„íŠ¼ í™œì„±í™”
            document.getElementById(sectionName).classList.add('active');
            // ì´ë²¤íŠ¸ íƒ€ê²Ÿì´ ì—†ì„ ê²½ìš° (ì˜ˆ: ì´ˆê¸° ë¡œë“œ ì‹œ)ë¥¼ ëŒ€ë¹„í•˜ì—¬ ì˜ˆì™¸ ì²˜ë¦¬
            const clickedButton = Array.from(buttons).find(btn => btn.onclick.toString().includes(`showSection('${sectionName}')`));
            if (clickedButton) {
                clickedButton.classList.add('active');
            }

            // íšŒê³„ë³´ê³ ì„œ íƒ­ìœ¼ë¡œ ì´ë™ ì‹œ ë³´ê³ ì„œ ì¬ìƒì„±
            if (sectionName === 'report') {
                generateReport();
            }
        }

        // ì…ì¶œê¸ˆ ê±°ë˜ ë“±ë¡ í•¨ìˆ˜
        function addTransaction(type) {
            // ì´ˆê¸° ì„¤ì •ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìœ¼ë©´ ê²½ê³ 
            if (!settings.isSetup) {
                showCustomAlert('ë¨¼ì € ì´ˆê¸° ì„¤ì •ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                return;
            }

            let amount, category, description, personName;

            if (type === 'income') { // ì…ê¸ˆ ì²˜ë¦¬
                amount = parseInt(document.getElementById('incomeAmount').value);
                category = document.getElementById('incomeCategory').value;
                description = document.getElementById('incomeDescription').value;
                personName = document.getElementById('incomePersonName').value.trim();

                if (!amount || amount <= 0) {
                    showCustomAlert('ì˜¬ë°”ë¥¸ ì…ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('incomeAmount').value = '';
                document.getElementById('incomeDescription').value = '';
                document.getElementById('incomePersonName').value = '';

            } else { // ì¶œê¸ˆ ì²˜ë¦¬
                amount = parseInt(document.getElementById('expenseAmount').value);
                category = document.getElementById('expenseCategory').value;
                description = document.getElementById('expenseDescription').value;
                personName = document.getElementById('expensePersonName').value.trim();

                if (!amount || amount <= 0) {
                    showCustomAlert('ì˜¬ë°”ë¥¸ ì¶œê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('expenseAmount').value = '';
                document.getElementById('expenseDescription').value = '';
                document.getElementById('expensePersonName').value = '';
            }

            // í˜„ì¬ ì”ì•¡ ê³„ì‚° ë° ìƒˆë¡œìš´ ì”ì•¡ ì ìš©
            const currentBalance = getCurrentBalance();
            const newBalance = type === 'income' ? currentBalance + amount : currentBalance - amount;

            // ìƒˆë¡œìš´ ê±°ë˜ ê°ì²´ ìƒì„±
            const transaction = {
                id: Date.now(), // ê³ ìœ  ID (íƒ€ì„ìŠ¤íƒ¬í”„ ì‚¬ìš©)
                // ë‚ ì§œì™€ ì‹œê°„ì„ í•¨ê»˜ ì €ì¥
                dateTime: new Date().toLocaleString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false }),
                date: new Date().toISOString().split('T')[0], // Store only date for history display
                type: type, // 'income' ë˜ëŠ” 'expense'
                category: category, // ì¹´í…Œê³ ë¦¬
                description: description, // ìƒì„¸ ë‚´ìš©
                amount: amount, // ê¸ˆì•¡
                balance: newBalance, // ê±°ë˜ í›„ ì”ì•¡
                personName: personName || 'ë¯¸ì…ë ¥' // ë‹´ë‹¹ì ì´ë¦„ (ì—†ìœ¼ë©´ 'ë¯¸ì…ë ¥')
            };

            transactions.push(transaction); // ê±°ë˜ ë‚´ì—­ì— ì¶”ê°€
            updateAllDisplays(); // ëª¨ë“  í™”ë©´ ì—…ë°ì´íŠ¸
            generateReport(); // ê±°ë˜ ë“±ë¡ ì‹œ ë³´ê³ ì„œ ì—…ë°ì´íŠ¸

            saveData(); // ë°ì´í„° ì €ì¥

            showCustomAlert(type === 'income' ? 'ì…ê¸ˆì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!' : 'ì¶œê¸ˆì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

       // ê±°ë˜ ì‚­ì œ í•¨ìˆ˜
        function deleteTransaction(transactionId) {
            const transaction = transactions.find(t => t.id === transactionId); // ì‚­ì œí•  ê±°ë˜ ì°¾ê¸°
            if (transaction) {
                // ì‚­ì œ í™•ì¸ ëŒ€í™”ìƒì
                showCustomConfirm(`${transaction.dateTime} ${transaction.category} ê±°ë˜(${transaction.amount.toLocaleString()}ì›)ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì£¼ì˜: ì´í›„ ê±°ë˜ë“¤ì˜ ì”ì•¡ì´ ëª¨ë‘ ì¬ê³„ì‚°ë©ë‹ˆë‹¤.`, () => {
                    // ê±°ë˜ ì‚­ì œ
                    const index = transactions.findIndex(t => t.id === transactionId);
                    transactions.splice(index, 1); // ë°°ì—´ì—ì„œ í•´ë‹¹ ê±°ë˜ ì œê±°

                    recalculateBalances(); // ì‚­ì œ í›„ ì”ì•¡ ì¬ê³„ì‚°
                    updateAllDisplays(); // ëª¨ë“  í™”ë©´ ì—…ë°ì´íŠ¸
                    generateReport(); // ê±°ë˜ ì‚­ì œ ì‹œ ë³´ê³ ì„œ ì—…ë°ì´íŠ¸

                    saveData(); // ë°ì´í„° ì €ì¥

                    showCustomAlert('ê±°ë˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                });
            }
        }

        // ëª¨ë“  ê±°ë˜ì˜ ì”ì•¡ì„ ì¬ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ (ê±°ë˜ ì‚­ì œ í›„ í˜¸ì¶œ)
        function recalculateBalances() {
            let currentBalance = settings.carryOverBalance; // ì´ì›” ì”ê³ ë¶€í„° ì‹œì‘

            // ë‚ ì§œì™€ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ìˆœì°¨ì ìœ¼ë¡œ ì”ì•¡ ê³„ì‚°
            transactions.sort((a, b) => new Date(a.dateTime) - new Date(b.dateTime));

            transactions.forEach(transaction => {
                if (transaction.type === 'income') {
                    currentBalance += transaction.amount;
                } else {
                    currentBalance -= transaction.amount;
                }
                transaction.balance = currentBalance; // ê±°ë˜ í›„ ì”ì•¡ ì—…ë°ì´íŠ¸
            });
        }

        // í˜„ì¬ ì´ ì”ì•¡ì„ ê³„ì‚°í•˜ì—¬ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
        function getCurrentBalance() {
            let balance = settings.carryOverBalance; // ì´ì›” ì”ê³ ë¶€í„° ì‹œì‘
            transactions.forEach(transaction => {
                if (transaction.type === 'income') {
                    balance += transaction.amount;
                } else {
                    balance -= transaction.amount;
                }
            });
            return balance;
        }

        // ëŒ€ì‹œë³´ë“œ ë° ê±°ë˜ ë‚´ì—­ í…Œì´ë¸”ì„ í¬í•¨í•œ ëª¨ë“  í™”ë©´ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        function updateAllDisplays() {
            updateDashboard();
            updateTransactionHistory();
        }

        // ëŒ€ì‹œë³´ë“œ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        function updateDashboard() {
            // ì´ ìˆ˜ì…, ì´ ì§€ì¶œ, í˜„ì¬ ì”ì•¡ ê³„ì‚°
            const totalIncome = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const totalExpense = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            const currentBalance = getCurrentBalance();

            // ê° ìš”ì†Œì— ê³„ì‚°ëœ ê°’ í‘œì‹œ
            document.getElementById('carryOverBalance').textContent = settings.carryOverBalance.toLocaleString() + 'ì›'; // ì´ì›” ì”ê³ ëŠ” ì„¤ì •ê°’ ê·¸ëŒ€ë¡œ
            document.getElementById('totalIncome').textContent = totalIncome.toLocaleString() + 'ì›';
            document.getElementById('totalExpense').textContent = totalExpense.toLocaleString() + 'ì›';
            document.getElementById('currentBalance').textContent = currentBalance.toLocaleString() + 'ì›';
            document.getElementById('transactionCount').textContent = transactions.length + 'ê±´';

            // ìµœê·¼ ê±°ë˜ì¼ í‘œì‹œ (ì´ì œ ë‚ ì§œì™€ ì‹œê°„ ëª¨ë‘ í‘œì‹œ)
            if (transactions.length > 0) {
                // Use the 'date' property for display
                document.getElementById('lastTransactionDate').textContent = new Date(transactions[transactions.length - 1].date).toLocaleDateString('ko-KR');
            } else {
                document.getElementById('lastTransactionDate').textContent = '-';
            }

            // ëŒ€ì‹œë³´ë“œì— ë‹¤ë½ë°© ì´ë¦„ í‘œì‹œ
            document.getElementById('dashboardDarakbangName').textContent = settings.darakbangName || '-';
        }

        // ê±°ë˜ ë‚´ì—­ í…Œì´ë¸”ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
        function updateTransactionHistory() {
            const tbody = document.getElementById('transactionHistory');

            // ëª¨ë“  ê±°ë˜ ë‚´ì—­ì„ í¬í•¨í•  ë°°ì—´ ìƒì„±
            let allTransactions = [];

            // ê¸°ì¡´ ê±°ë˜ ë‚´ì—­ ì¶”ê°€
            allTransactions = allTransactions.concat(transactions);

            if (allTransactions.length === 0 && !settings.isSetup) { // ì„¤ì •ì´ ì•ˆë˜ì–´ìˆìœ¼ë©´ ì´ì›”ì”ê³ ë„ ì•ˆë³´ì—¬ì¤Œ
                // ê±°ë˜ ë‚´ì—­ì´ ì—†ìœ¼ë©´ ë©”ì‹œì§€ í‘œì‹œ
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; color: #666;">ë“±ë¡ëœ ê±°ë˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            tbody.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì§€ìš°ê¸°

            // ë‚ ì§œì™€ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ê°€ì¥ ìµœì‹  ê±°ë˜ê°€ ìœ„ë¡œ ì˜¤ë„ë¡)
            allTransactions.sort((a, b) => new Date(b.dateTime) - new Date(a.dateTime));

            // ì •ë ¬ëœ ê±°ë˜ ë‚´ì—­ì„ ìˆœíšŒí•˜ë©° í…Œì´ë¸”ì— ì¶”ê°€
            allTransactions.forEach((transaction) => {
                const row = tbody.insertRow(); // ìƒˆë¡œìš´ í–‰ ì¶”ê°€
                row.innerHTML = `
                    <td>${transaction.date}</td> <td>${transaction.type === 'income' ? 'ì…ê¸ˆ' : 'ì¶œê¸ˆ'}</td>
                    <td>${transaction.category}</td>
                    <td>${transaction.description}</td>
                    <td>${transaction.personName}</td>
                    <td class="${transaction.type}">${transaction.type === 'income' ? '+' : '-'}${transaction.amount.toLocaleString()}ì›</td>
                    <td>${transaction.balance.toLocaleString()}ì›</td>
                    <td><button onclick="deleteTransaction(${transaction.id})" style="background: #c8a48a; color: white; border: none; padding: 5px 10px; border-radius: 15px; cursor: pointer; font-size: 12px;">ğŸ—‘ï¸</button></td>
                `;
            });

            // ì´ì›” ì”ê³  í•­ëª© ìƒì„± ë° ê°€ì¥ ì•„ë˜ì— ì¶”ê°€
            if (settings.isSetup) { // ì„¤ì •ì´ ì™„ë£Œëœ ê²½ìš°ì—ë§Œ ì´ì›” ì”ê³  í•­ëª© ì¶”ê°€
                const carryOverRow = tbody.insertRow();
                carryOverRow.innerHTML = `
                    <td>${settings.baseDate || '-'}</td> <td>ì´ì›”</td>
                    <td>-</td>
                    <td>ì´ì›” ì”ê³ </td>
                    <td>-</td>
                    <td>+${settings.carryOverBalance.toLocaleString()}ì›</td>
                    <td>${settings.carryOverBalance.toLocaleString()}ì›</td>
                    <td></td> `;
            }
        }

        // íšŒê³„ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ê³  í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function generateReport() {
            // ë³´ê³ ì„œ ê¸°ê°„ ì„¤ì • ê°€ì ¸ì˜¤ê¸°
            const startDate = document.getElementById('reportStartDate').value;
            const endDate = document.getElementById('reportEndDate').value;

            // ê¸°ê°„ì— ë§ëŠ” ê±°ë˜ í•„í„°ë§
            let filteredTransactions = transactions;

            if (startDate && endDate) {
                filteredTransactions = transactions.filter(transaction => {
                    // dateTime ì†ì„±ì„ Date ê°ì²´ë¡œ ë³€í™˜í•˜ì—¬ ë¹„êµ
                    const transactionDateTime = new Date(transaction.dateTime);
                    const start = new Date(startDate);
                    const end = new Date(endDate);
                    // ì¢…ë£Œ ë‚ ì§œëŠ” í•´ë‹¹ ë‚ ì§œì˜ 23:59:59ê¹Œì§€ í¬í•¨í•˜ë„ë¡ ì„¤ì •
                    end.setHours(23, 59, 59, 999);
                    return transactionDateTime >= start && transactionDateTime <= end;
                });
            } else if (startDate) {
                filteredTransactions = transactions.filter(transaction => {
                    const transactionDateTime = new Date(transaction.dateTime);
                    const start = new Date(startDate);
                    return transactionDateTime >= start;
                });
            } else if (endDate) {
                filteredTransactions = transactions.filter(transaction => {
                    const transactionDateTime = new Date(transaction.dateTime);
                    const end = new Date(endDate);
                    end.setHours(23, 59, 59, 999);
                    return transactionDateTime <= end;
                });
            } else {
                // ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œê°€ ëª¨ë‘ ë¹„ì–´ìˆìœ¼ë©´ ì „ì²´ ê¸°ê°„ìœ¼ë¡œ ì„¤ì •
                filteredTransactions = [...transactions];
            }

            // ê¸°ê°„ ì‹œì‘ ì „ê¹Œì§€ì˜ ì”ì•¡ ê³„ì‚°
            let periodStartBalance = settings.carryOverBalance;
            if (startDate) {
                const beforeStartTransactions = transactions.filter(transaction => {
                    const transactionDateTime = new Date(transaction.dateTime);
                    const start = new Date(startDate);
                    return transactionDateTime < start;
                });
                beforeStartTransactions.forEach(transaction => {
                    if (transaction.type === 'income') {
                        periodStartBalance += transaction.amount;
                    } else {
                        periodStartBalance -= transaction.amount;
                    }
                });
            }

            // í•„í„°ë§ëœ ê±°ë˜ ë‚´ì—­ì˜ ì´ ìˆ˜ì… ë° ì´ ì§€ì¶œ ê³„ì‚°
            const totalIncomeInPeriod = filteredTransactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const totalExpenseInPeriod = filteredTransactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);

            // ê¸°ê°„ ì¢…ë£Œ ì‹œì ì˜ ì”ì•¡ ê³„ì‚°
            const periodEndBalance = periodStartBalance + totalIncomeInPeriod - totalExpenseInPeriod;

            // ì¹´í…Œê³ ë¦¬ë³„ ìˆ˜ì… ì§‘ê³„ ì´ˆê¸°í™”
            const incomeByCategory = {
                'ì´ì›” ì”ê³ ': periodStartBalance, // ê¸°ê°„ ì‹œì‘ ì”ì•¡ì„ ì´ì›” ì”ê³ ë¡œ í‘œì‹œ
                'ë‹¤ë½ë°© í—Œê¸ˆ': 0, 'ëª¨ì„ë¹„': 0, 'í›„ì›ê¸ˆ': 0, 'ì´ììˆ˜ì…': 0, 'ê¸°íƒ€ìˆ˜ì…': 0
            };

            // ì¹´í…Œê³ ë¦¬ë³„ ì§€ì¶œ ì§‘ê³„ ì´ˆê¸°í™”
            const expenseByCategory = {
                'ë‹¤ë½ë°© í—Œê¸ˆ': 0, 'ì‹ì‚¬ë¹„': 0, 'ì—´ë¦° ë‹¤ë½ë°© ëª¨ì„ë¹„': 0, 'ì„ ë¬¼ë¹„': 0, 'í–‰ì‚¬ë¹„': 0, 'ê¸°íƒ€ì§€ì¶œ': 0
            };

            // í•„í„°ë§ëœ ê±°ë˜ ë‚´ì—­ì„ ìˆœíšŒí•˜ë©° ì¹´í…Œê³ ë¦¬ë³„ ê¸ˆì•¡ ê³„ì‚°
            filteredTransactions.forEach(transaction => {
                if (transaction.type === 'income' && incomeByCategory.hasOwnProperty(transaction.category)) {
                    incomeByCategory[transaction.category] += transaction.amount;
                } else if (transaction.type === 'expense' && expenseByCategory.hasOwnProperty(transaction.category)) {
                    expenseByCategory[transaction.category] += transaction.amount;
                }
            });

            // ë³´ê³ ì„œ ë‚ ì§œ ì •ë³´ ì—…ë°ì´íŠ¸
            document.getElementById('reportDate').textContent = new Date().toLocaleDateString('ko-KR');
            document.getElementById('reportDarakbangName').textContent = settings.darakbangName || '-'; // ë‹¤ë½ë°© ì´ë¦„ í‘œì‹œ
            document.getElementById('reportManager').textContent = settings.managerName || '-';

            // ë³´ê³ ì„œ ê¸°ê°„ í…ìŠ¤íŠ¸ ì„¤ì •
            let periodText = 'ì „ì²´ ê¸°ê°„';
            if (startDate && endDate) {
                periodText = `${startDate} ~ ${endDate}`;
            } else if (startDate) {
                periodText = `${startDate} ì´í›„`;
            } else if (endDate) {
                periodText = `${endDate} ì´ì „`;
            }
            document.getElementById('reportPeriod').textContent = periodText;

            // í†µí•© ë³´ê³ ì„œ í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const consolidatedReportTbody = document.getElementById('consolidatedReport').querySelector('tbody');
            consolidatedReportTbody.innerHTML = '';

            // ìˆ˜ì… ë‚´ì—­ ì¶”ê°€
            consolidatedReportTbody.innerHTML += `
                <tr><td colspan="2" style="font-weight: bold; background-color: #f0f0f0;">ğŸ’¼ ìˆ˜ì… ë‚´ì—­ ìš”ì•½</td></tr>
            `;
            for (const category in incomeByCategory) {
                if (incomeByCategory.hasOwnProperty(category)) {
                    const row = consolidatedReportTbody.insertRow();
                    row.innerHTML = `<td>${category}</td><td class="income-amount">${incomeByCategory[category].toLocaleString()}ì›</td>`;
                }
            }
            consolidatedReportTbody.innerHTML += `
                <tr class="total-row"><td><strong>ì´ ìˆ˜ì…</strong></td><td class="amount income-amount"><strong>${(totalIncomeInPeriod + periodStartBalance).toLocaleString()}ì›</strong></td></tr>
            `;

            // ì§€ì¶œ ë‚´ì—­ ì¶”ê°€
            consolidatedReportTbody.innerHTML += `
                <tr><td colspan="2" style="font-weight: bold; background-color: #f0f0f0; padding-top: 20px;">ğŸ’¸ ì§€ì¶œ ë‚´ì—­ ìš”ì•½</td></tr>
            `;
            for (const category in expenseByCategory) {
                if (expenseByCategory.hasOwnProperty(category)) {
                    const row = consolidatedReportTbody.insertRow();
                    row.innerHTML = `<td>${category}</td><td class="expense-amount">${expenseByCategory[category].toLocaleString()}ì›</td>`;
                }
            }
            consolidatedReportTbody.innerHTML += `
                <tr class="total-row"><td><strong>ì´ ì§€ì¶œ</strong></td><td class="amount expense-amount"><strong>${totalExpenseInPeriod.toLocaleString()}ì›</strong></td></tr>
            `;

            // ìµœì¢… ê²°ì‚° ì¶”ê°€
            consolidatedReportTbody.innerHTML += `
                <tr><td colspan="2" style="font-weight: bold; background-color: #f0f0f0; padding-top: 20px;">ğŸ“ˆ ìµœì¢… ê²°ì‚°</td></tr>
                <tr><td>ê¸°ê°„ ì‹œì‘ ì”ì•¡</td><td class="balance-amount">${periodStartBalance.toLocaleString()}ì›</td></tr>
                <tr><td>ì´ ìˆ˜ì…</td><td class="income-amount">+${totalIncomeInPeriod.toLocaleString()}ì›</td></tr>
                <tr><td>ì´ ì§€ì¶œ</td><td class="expense-amount">-${totalExpenseInPeriod.toLocaleString()}ì›</td></tr>
                <tr class="total-row"><td><strong>ê¸°ê°„ ì¢…ë£Œ ì”ì•¡</strong></td><td class="amount balance-amount"><strong>${periodEndBalance.toLocaleString()}ì›</strong></td></tr>
            `;
        }

        // ë³´ê³ ì„œ ì¸ì‡„ í•¨ìˆ˜
        function printReport() {
            window.print();
        }

        // ì»¤ìŠ¤í…€ ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜ (alert ëŒ€ì²´)
        function showCustomAlert(message) {
            const alertBox = document.createElement('div');
            alertBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #f5f2f0;
                padding: 25px 35px;
                border-radius: 15px;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                text-align: center;
                font-size: 16px;
                color: #5a5a5a;
                border: 2px solid #d4b5a0;
                max-width: 80%;
                line-height: 1.5;
            `;
            alertBox.innerHTML = `
                <p>${message.replace(/\n/g, '<br>')}</p>
                <button onclick="this.parentNode.remove()" style="
                    margin-top: 20px;
                    padding: 10px 25px;
                    background: linear-gradient(135deg, #a8b59c 0%, #9ca892 100%);
                    color: white;
                    border: none;
                    border-radius: 20px;
                    cursor: pointer;
                    font-size: 15px;
                    font-weight: bold;
                    transition: all 0.3s ease;
                ">í™•ì¸</button>
            `;
            document.body.appendChild(alertBox);
        }

        // ì»¤ìŠ¤í…€ í™•ì¸ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜ (confirm ëŒ€ì²´)
        function showCustomConfirm(message, onConfirm) {
            const confirmBox = document.createElement('div');
            confirmBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #f5f2f0;
                padding: 25px 35px;
                border-radius: 15px;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                text-align: center;
                font-size: 16px;
                color: #5a5a5a;
                border: 2px solid #d4b5a0;
                max-width: 80%;
                line-height: 1.5;
            `;
            confirmBox.innerHTML = `
                <p>${message.replace(/\n/g, '<br>')}</p>
                <div style="margin-top: 20px; display: flex; justify-content: center; gap: 10px;">
                    <button id="customConfirmYes" style="
                        padding: 10px 25px;
                        background: linear-gradient(135deg, #7d8471 0%, #6b7560 100%);
                        color: white;
                        border: none;
                        border-radius: 20px;
                        cursor: pointer;
                        font-size: 15px;
                        font-weight: bold;
                        transition: all 0.3s ease;
                    ">ì˜ˆ</button>
                    <button id="customConfirmNo" style="
                        padding: 10px 25px;
                        background: linear-gradient(135deg, #c8a48a 0%, #b5936d 100%);
                        color: white;
                        border: none;
                        border-radius: 20px;
                        cursor: pointer;
                        font-size: 15px;
                        font-weight: bold;
                        transition: all 0.3s ease;
                    ">ì•„ë‹ˆì˜¤</button>
                </div>
            `;
            document.body.appendChild(confirmBox);

            document.getElementById('customConfirmYes').onclick = () => {
                confirmBox.remove();
                onConfirm();
            };
            document.getElementById('customConfirmNo').onclick = () => {
                confirmBox.remove();
            };
        }
    </script>
</body>
</html>
                 